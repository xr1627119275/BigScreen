<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>设备管理</title>
    <link rel="stylesheet" href="./css/clear.css">
    <link rel="stylesheet" href="./css/home.css">
    <script src="./js/jquery.min.js"></script>
    <link rel="stylesheet" href="./js/layui/dist/css/layui.css">
    <script src="./js/layui/dist/layui.js"></script>
    <script src="./js/echarts.min.js"></script>

    <style>

    </style>
</head>
<body style="position: relative; overflow: hidden">
<div id="screen">

    <div id="header" style="width: 100%; height: 101px; vertical-align: middle" ></div>

    <div id="plate_nav" style="padding: 14px 0 27px 0;">
        <div class="plate_item">
            <div class="plate_box">
                <div class="plate_til">设备总数</div>
                <div class="plate_num">
                    <p>
                        <span>123</span>
                    </p>
                </div>
            </div>
        </div>
        <div class="plate_item">
            <div class="plate_box">
                <div class="plate_til">租赁设备</div>
                <div class="plate_num">
                    <p>
                        <span>3</span>
                    </p>
                </div>
            </div>
        </div>
        <div class="plate_item">
            <div class="plate_box">
                <div class="plate_til">分包自带</div>
                <div class="plate_num">
                    <p>
                        <span>3</span>
                    </p>
                </div>
            </div>
        </div>
        <div class="plate_item">
            <div class="plate_box">
                <div class="plate_til">闲置设备</div>
                <div class="plate_num">
                    <p>
                        <span>23</span>
                    </p>
                </div>
            </div>
        </div>
        <div class="plate_item">
            <div class="plate_box">
                <div class="plate_til">大型设备</div>
                <div class="plate_num">
                    <p>
                        <span>23</span>
                    </p>
                </div>
            </div>
        </div>
        <div class="plate_item">
            <div class="plate_box">
                <div class="plate_til">特种设备</div>
                <div class="plate_num">
                    <p>
                        <span>3</span>
                    </p>
                </div>
            </div>
        </div>
        <div class="plate_item">
            <div class="plate_box">
                <div class="plate_til">利用率</div>
                <div class="plate_num">
                    <p>
                        <span>20%</span>
                    </p>
                </div>
            </div>
        </div>
    </div>
    <main>
        <div class="charts_content_box charts_content_box_280_2nav" style="height: 280px">
            <div class="content-header">
                <span class="ch-tit">租赁合同</span>
            </div>
            <div class="main_body" style="">
                <div class="icon_wyc" style="height: 110px; ">
                    <div class="wyc_item">
                        <i class="icon48" style="background-image: url('./img/top_icon_w.png');"></i>
                        <div class="wyc_content">
                            <p>
                                <span>0</span>
                                <span>/个</span>
                            </p>
                            <p>本月</p>
                        </div>
                    </div>
                    <div class="wyc_item">
                        <i class="icon48" style="background-image: url('./img/top_icon_y.png');"></i>
                        <div class="wyc_content">
                            <p>
                                <span>12</span>
                                <span>/个</span>
                            </p>
                            <p>本年</p>
                        </div>
                    </div>
                    <div class="wyc_item">
                        <i class="icon48" style="background-image: url('./img/top_icon_c.png');"></i>
                        <div class="wyc_content">
                            <p>
                                <span>23</span>
                                <span>/个</span>
                            </p>
                            <p>开累</p>
                        </div>
                    </div>
                </div>
                <div class="content-header" >
                    <span class="ch-tit">租赁结算</span>
                </div>
                <div class="icon_wyc" style="height: 110px; ">
                    <div class="wyc_item">
                        <i class="icon48" style="background-image: url('./img/bottom_icon_w.png');"></i>
                        <div class="wyc_content">
                            <p>
                                <span>0</span>
                                <span>/万</span>
                            </p>
                            <p>本月</p>
                        </div>
                    </div>
                    <div class="wyc_item">
                        <i class="icon48" style="background-image: url('./img/bottom_icon_y.png');"></i>
                        <div class="wyc_content">
                            <p>
                                <span>345.23</span>
                                <span>/万</span>
                            </p>
                            <p>本年</p>
                        </div>
                    </div>
                    <div class="wyc_item">
                        <i class="icon48" style="background-image: url('./img/bottom_icon_c.png');"></i>
                        <div class="wyc_content">
                            <p>
                                <span>875.23</span>
                                <span>/万</span>
                            </p>
                            <p>开累</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div class="charts_content_box_280" style="height: 280px">
            <div class="content-header">
                <span class="ch-tit">结算费用组成</span>
                <span class="ch-tit nav_tit_right_tip" >单位：元</span>
            </div>
            <div class="main_body">
                <div id="SettlementFee" class="pie_chart"></div>
            </div>
        </div>

        <div class="charts_content_box_280" style="height: 280px">
            <div class="content-header">
                <span class="ch-tit">租赁费产值比/临租费占比</span>
            </div>
            <div class="main_body" style="display:flex; align-items: center; justify-content: space-around">
                <div class="percent_cricle">
                    <div class="percent_num">4%</div>
                    <div class="percent_desc">租赁费产值比</div>
                </div>
                <div class="percent_cricle">
                    <div class="percent_num">20%</div>
                    <div class="percent_desc">临租费占比</div>
                </div>
            </div>
        </div>

        <div class="charts_content_box_280" style="height: 280px">
            <div class="content-header">
                <span class="ch-tit">设备类型统计</span>
                <span class="ch-tit nav_tit_right_tip" >单位：台</span>

            </div>
            <div class="main_body">
                <div id="DeviceType" class="pie_chart"></div>
            </div>
        </div>

        <div class="charts_content_box_280" style="height: 280px">
            <div class="content-header">
                <span class="ch-tit">设备利用率排行统计</span>
                <span class="ch-tit nav_tit_right_tip" >单位：%</span>
            </div>
            <div class="main_body">
                <div id="DeviceUsedPercent" class="pie_chart"></div>
            </div>
        </div>

        <div class="charts_content_box_280" style="height: 280px">
            <div class="content-header">
                <span class="ch-tit">设备运行分析</span>
                <div class="nav_tit nav_tit_right_v2" data-value="90" style="margin-right: 20px">
                    <span class="ch-tit">近3月</span>
                </div>
                <div class="nav_tit nav_tit_right_v2 " data-value="30">
                    <span class="ch-tit">近1月</span>
                </div>
                <div class="nav_tit nav_tit_right_v2 active" data-value="7" >
                    <span class="ch-tit">近7天</span>
                </div>
            </div>
            <div class="main_body">
                <div id="DeviceRunAnalysis" class="pie_chart"></div>
            </div>
        </div>
        <div class="charts_content_box charts_content_box_220" style="width: 100%; height: 220px">
            <div class="content-header">
                <div class="nav_tit active" >
                    <span class="ch-tit ">自有设备</span>
                </div>
                <div class="nav_tit ">
                    <span class="ch-tit">租赁设备</span>
                </div>
                <div class="nav_tit " >
                    <span class="ch-tit">分包自带设备</span>
                </div>
            </div>
            <div id="_Table"  class="main_body main_body_table" >
                <div class="nav_tab_content" style="display: block">
                        <table id="table1"></table>
                </div>
                <div class="nav_tab_content">
                        <table id="table2"></table>
                </div>
                <div class="nav_tab_content">
                        <table id="table3"></table>
                </div>
            </div>
        </div>
    </main>


</div>
<canvas id="canvas" style="position: absolute; top: 0; z-index: 0"></canvas>
<script src="./js/common.js"></script>
<script src="./js/bg.js"></script>
<script>
    var form, table;
    var Charts = {}



    layui.use(['form' ,'table'], function (){
        form = layui.form
        table = layui.table
        form.render('select')
        renderTable1()
        renderTable2()
        renderTable3()
    })

    $(function () {
        initPieChart($("#SettlementFee")[0], "SettlementFee",
            [
                {name: '设备租赁结算', value: '2345355'},
                {name: '无合同结算', value: '5067341'},
                {name: '设备维修结算', value: '338157'},
            ],
            {
                series: {
                    radius: ['55%', '80%'],
                },
                _formatter: function (name, value) {
                    var arr = [
                        '{icon|}{name|' + name + '}',
                        '{value|' + fmoney(value, 0) + '}',
                    ];
                    return arr.join('\n')
                },
                legend: {
                    itemGap: 20,
                    textStyle: {
                        rich: {
                            icon: {
                                height: 16,
                            },
                            name: {
                                color: "#fff",
                                padding: [0, 0, 0, 10],
                            },
                            value: {
                                align: 'left',
                                padding: [10, 0, 0, 0],
                            },
                        }
                    }
                },
            }
        )


        initCategoryChart($("#DeviceType")[0], 'DeviceType', ["汽车起重机", "叉车", "履带挖掘机", "随车起重机", "载重汽车"]
            , [20, 17, 16, 12, 10],
            {
                xAxis: {
                    axisLabel: {
                        textStyle: {
                            color: '#40F3EF'
                        }
                    }
                }
            }
        )
        initCategoryChart($("#DeviceUsedPercent")[0], 'DeviceUsedPercent', ["皖A26301", "皖A25601", "皖A41820", "皖A25193", "皖A26363", "皖A26301", "皖A25601", "皖A41820", "皖A25193", "皖A26363"]
            , [81, 78, 70, 51, 40, 81, 78, 70, 51, 40],
            {
                dataZoom: {
                    type: 'inside',
                    realtime: true,
                    startValue: 0,
                    endValue: 4,
                },
                xAxis: {
                    axisLabel: {
                        textStyle: {
                            color: '#40F3EF'
                        }
                    }
                }
            }
        )

        var baseYAxis = {
            show: true,
            type: 'value',
            splitLine: {
                lineStyle: {
                    color: [splitLineColor]
                }
            },
            nameTextStyle: {
                fontSize: 16,
                color: '#FEFFFF',
                padding: [0 ,0,0, 80]
            },
            axisLabel: {
                show: true,
                textStyle: {
                    fontSize: 16,
                    color: '#FEFFFF'
                }
            }
        }
        initCategoryChart($("#DeviceRunAnalysis")[0], 'DeviceRunAnalysis', ["皖A26301", "皖A25601", "皖A41820", "皖A25193", "皖A26363", "皖A26301", "皖A25601", "皖A41820", "皖A25193", "皖A26363"]
            , undefined ,
            {
                dataZoom: {
                    type: 'inside',
                    realtime: true,
                    startValue: 0,
                    endValue: 4,
                },
                yAxis: [

                    Object.assign( {
                        name: '工作时长(h)'
                    },baseYAxis),
                    {
                        name: '耗油量(L)',
                        nameTextStyle: {
                            fontSize: 16,
                            color: '#FEFFFF',
                            padding: [0 ,80,0,0]
                        },
                        splitLine: {
                            show: false
                        },
                        axisLabel: {
                            show: true,
                            textStyle: {
                                fontSize: 16,
                                color: '#FEFFFF'
                            }
                        }
                    },
                ],
                xAxis: {
                    axisLabel: {
                        textStyle: {
                            color: '#40F3EF'
                        }
                    }
                },
                grid: {
                    x2: 50
                },
                series: [
                    {
                        data: [81, 78, 70, 51, 40],
                        type: 'bar',
                        barWidth: 30,
                    },
                    {
                        type: 'line',
                        yAxisIndex: 1,
                        lineStyle: {
                            color: '#36C0C5',
                            width: 1
                        },
                        data: [41, 68, 50, 41, 30],
                    }
                ]
            }
        )
    })
    function renderTable1() {

        window._table = table.render({
            elem: '#table1',
            height: $("#table1").parent().height() - 20,
            data: [
                {name1: '履带式液压挖掘机', name2: '15t', name3: '履带式液压挖掘机', name4: '101-0004W-0408', name5: '在用', name6: '2021年09月16日'},
                {name1: '履带式液压挖掘机', name2: '15t', name3: '履带式液压挖掘机', name4: '101-0004W-0408', name5: '在用', name6: '2021年09月16日'},
                {name1: '履带式液压挖掘机', name2: '15t', name3: '履带式液压挖掘机', name4: '101-0004W-0408', name5: '在用', name6: '2021年09月16日'},
                {name1: '履带式液压挖掘机', name2: '15t', name3: '履带式液压挖掘机', name4: '101-0004W-0408', name5: '在用', name6: '2021年09月16日'},
            ],
            cols: [
                [
                    { field: 'name1', title: '设备名称' },
                    { field: 'name2', title: '规格' },
                    { field: 'name3', title: '设备类型' },
                    { field: 'name4', title: '管理号码' },
                    { field: 'name5', title: '设备状态' },
                    { field: 'name6', width: '15%', title: '进场时间' },
                ]
            ],
            done: function() {
                $("#_Table .layui-table-body").eq(0).layTableScroll()
            }
        })

    }

    function renderTable2() {

        window._table = table.render({
            elem: '#table2',
            height: $("#table2").parent().height() - 20,
            data: [
                {name1: '箱梁架设1', name2: '箱梁架设', name3: '其他附厲设施', name4: '铺轨基地驻地、办公区生活用电、生产用电', name5: '桥梁倾覆、设备侧翻、设备 故障、人员伤亡', name6: '2021-07-01至2021-09-30', name7: '三级', name8: '已消除', name9: '未预警' },
            ],
            cols: [
                [
                    { field: 'name1', title: '单位工程' },
                    { field: 'name2', title: '分部分项工程' },
                    { field: 'name3', title: '施工工序' },
                    { field: 'name4', title: '风险项目名称' },
                    { field: 'name5', title: '风险概况描述' },
                    { field: 'name6', width: '15%', title: '计划施工时段' },
                    { field: 'name7', title: '风险等级' },
                    { field: 'name8', title: '风险状态' },
                    { field: 'name9', title: '预警状态' },
                ]
            ],
            done: function() {
                $("#_Table .layui-table-body").eq(1).layTableScroll()
            }
        })

    }

    function renderTable3() {

        window._table = table.render({
            elem: '#table3',
            height: $("#table3").parent().height() - 20,
            data: [
                {name1: '箱梁架设1', name2: '箱梁架设', name3: '其他附厲设施', name4: '铺轨基地驻地、办公区生活用电、生产用电', name5: '桥梁倾覆、设备侧翻、设备 故障、人员伤亡', name6: '2021-07-01至2021-09-30', name7: '三级', name8: '已消除', name9: '未预警' },
            ],
            cols: [
                [
                    { field: 'name1', title: '单位工程' },
                    { field: 'name2', title: '分部分项工程' },
                    { field: 'name3', title: '施工工序' },
                    { field: 'name4', title: '风险项目名称' },
                    { field: 'name5', title: '风险概况描述' },
                    { field: 'name6', width: '15%', title: '计划施工时段' },
                    { field: 'name7', title: '风险等级' },
                    { field: 'name8', title: '风险状态' },
                    { field: 'name9', title: '预警状态' },
                ]
            ],
            done: function() {
                $("#_Table .layui-table-body").eq(2).layTableScroll()
            }
        })

    }

    $(window).resize(() => {
        for (var key in Charts) {
            if (!Charts[key]) continue
            Charts[key].resize()
        }
    });

</script>
<script src="./js/bigscreen.js"></script>
<script src="./js/echarts-component.js"></script>
</body>
</html>